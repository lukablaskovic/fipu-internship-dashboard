import{r as v,w as Q,x as c,G as f,J as t,z as u,F as e,u as a,y as O,I as W,_ as Y,a as P,f as B,A,K as J,Q as X,P as H}from"./vue.7e7f5872.js";import{c as _,r as $,f as R,m as ee,h as ae,b as oe,s as N,u as te,g as S}from"./validators.2340ccfd.js";import{m as o,t as se,s as L,U as V,b as re,d as ne}from"./index.8a815c4b.js";import{aX as ie,_ as M,a as le,k as ue,c as j,K as de,aY as q,t as me,aZ as ce,b as d,B as pe,a_ as _e,a$ as fe,b0 as ve,b1 as F,I as we,J as ge}from"./BaseButton.1e728d8c.js";import{_ as be,a as ke}from"./SectionTitleLineWithButton.f6e95eda.js";import{_ as C}from"./CardBox.df29294d.js";import{c as he}from"./SnackBar.fa913be1.js";import{_ as m}from"./FormField.a1bdf2d9.js";import{_ as I}from"./BaseButtons.06021fb9.js";import{e as Ae,a as je}from"./LayoutAuthenticated.90c3e678.js";import{S as ye}from"./maps.05bf61c1.js";import{_ as Ve}from"./FormFilePicker.b782ee71.js";import{c as y}from"./TableAvailableAssignments.2e62d9af.js";import{h as Me}from"./moment-setup.c6085169.js";import"./vendor.4c47bd8f.js";import"./FormCheckRadio.eb16ec4e.js";import"./FormCheckRadioGroup.c52e2c40.js";import"./LoadingOverlay.157b2581.js";const xe={class:"absolute right-0 bottom-0"},ze={__name:"UserAvatarCurrentUserWithUpload",setup(k){const s=v(null);return Q(s,async r=>{if(r)try{o.avatarChanging=!0;let i=null;if(o.userAdmin===!1)i=await o.updateAvatarStudent(o.currentUser.JMBAG,r),o.avatarChanging=!1;else if(o.userAdmin===!0){if(i=await o.updateAvatarAdmin(r),i.status_code===200){let w=await se.updateAdminAvatarInPostgres(o.currentUser.username,i.data.url);if(o.avatarChanging=!1,!w)return}}else return;i.status_code===200?(await o.fetchCurrentUser(),L.pushMessage("Avatar uspje\u0161no promijenjen!","success"),await V.wait(3),location.reload()):(L.pushMessage("Gre\u0161ka prilikom promjene avatara!","danger"),await V.wait(3),location.reload())}catch(i){console.error("Failed to upload avatar:",i)}}),(r,i)=>(c(),f(Ae,{class:"relative"},{default:t(()=>[u("div",xe,[e(Ve,{modelValue:s.value,"onUpdate:modelValue":i[0]||(i[0]=w=>s.value=w),icon:a(ie),"is-round-icon":""},null,8,["modelValue","icon"])])]),_:1}))}},Ue={},Be={class:"rounded-2xl py-12 px-6 lg:px-12 text-center"};function $e(k,s){return c(),O("div",Be,[W(k.$slots,"default")])}const D=re(Ue,[["render",$e]]),Se=u("h1",{class:"text-3xl text-white mb-6"},"Pogledajte aktivne prakse",-1),Ce=u("h1",{class:"text-3xl text-white mb-6"},"Provjerite stanje va\u0161e prakse",-1),Ge={__name:"SectionBannerProfile",setup(k){return(s,r)=>{const i=Y("router-link");return a(o).userAdmin?(c(),f(D,{key:0,class:"bg-gradient-to-tr from-green-300 via-fipu_blue to-blue-500"},{default:t(()=>[Se,e(i,{to:"/studenti"},{default:t(()=>[e(M,{icon:a(le),label:"Studenti",target:"_blank","rounded-full":""},null,8,["icon"])]),_:1})]),_:1})):(c(),f(D,{key:1,class:"bg-gradient-to-tr from-green-300 via-fipu_blue to-blue-500"},{default:t(()=>[Ce,e(i,{to:"/moja-praksa"},{default:t(()=>[e(M,{icon:a(ue),label:"Moja praksa",target:"_blank","rounded-full":""},null,8,["icon"])]),_:1})]),_:1}))}}},Pe={class:"grid grid-cols-1 xl:grid-cols-2 gap-6 mb-6"},Je={class:"flex justify-start items-start"},Ne={class:"flex-1"},Le={class:"flex justify-between items-center"},qe={class:"flex justify-start items-center mb-3"},Fe={class:"text-2xl mr-1.5"},Ie={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},De={key:1},ia={__name:"ProfileView",setup(k){const s=P({username:o.currentUser.username,ime:o.currentUser.ime,prezime:o.currentUser.prezime,JMBAG:o.currentUser.JMBAG,account_type:o.currentUser.account_type,godina_studija:o.currentUser.godina_studija,email:o.currentUser.email}),r=P({password_current:"",password:"",password_confirmation:""}),i=B(()=>r.password),w=B(()=>r.password_current),E={password_current:{required:_.withMessage("Polje je obavezno",$)},password:{sameAs:_.withMessage("Nova lozinka ne smije biti identi\u010Dna staroj",R(N(w))),required:_.withMessage("Polje je obavezno",$),minLength:_.withMessage("Lozinka mora sadr\u017Eavati minimalno 6 znakova",ee(6)),containsAlpha:_.withMessage("Lozinka mora sadr\u017Eavati barem jedno slovo",ae),containsNumeric:_.withMessage("Lozinka mora sadr\u017Eavati barem jedan broj",oe)},password_confirmation:{required:_.withMessage("Polje je obavezno",$),sameAs:_.withMessage("Lozinke se ne podudaraju",N(i))}},g=te(E,r),b=v(!1);async function K(){if(b.value=!0,g.value.$touch(),g.value.$invalid){b.value=!1;return}(await o.updatePassword(r.password_current,r.password)).message=="Invalid old password. Please try again."?G("warning"):(G("success"),await V.wait(2),o.logout()),await V.wait(3),b.value=!1}const p=v(null);let x=v(),z=v();const T=v([]),U=B(()=>T.value.indexOf("outline")>-1);function G(h){switch(h){case"success":p.value.color="success",p.value.icon=ge,p.value.duration=1,x.value="To je to!",z.value=" Lozinka uspje\u0161no promijenjena!";break;case"warning":p.value.color="warning",p.value.icon=we,p.value.duration=1,x.value="Upozorenje.",z.value=" Pogre\u0161na stara lozinka. Molimo poku\u0161ajte ponovno.";break}p.value.show()}return(h,n)=>{const Z=Y("NotificationBar");return c(),f(je,null,{default:t(()=>[e(ke,null,{default:t(()=>[e(be,{icon:a(j),title:"Korisni\u010Dki profil",main:""},null,8,["icon"]),u("div",Pe,[e(C,{flex:"flex-row",class:"items-center rounded"},{default:t(()=>[u("div",Je,[e(ze,{class:"w-24 h-24 md:w-36 md:h-36 mr-6"}),u("div",Ne,[u("div",Le,[u("div",qe,[u("h1",Fe,A(a(o).currentUser.ime)+" "+A(a(o).currentUser.prezime),1),e(ne,{path:a(de),size:22,class:"text-blue-400"},null,8,["path"])])]),e(I,{class:"text-fipu_gray dark:text-gray-300"},{default:t(()=>[a(o).userAdmin?(c(),f(y,{key:0,"reverse-dark":!0,label:"Admin",icon:a(q)},null,8,["icon"])):(c(),f(y,{key:1,"reverse-dark":!0,label:"Student",icon:a(q)},null,8,["icon"])),e(y,{"reverse-dark":!0,label:"FIPU",icon:a(me)},null,8,["icon"]),e(y,{"reverse-dark":!0,label:a(Me).parseZone(a(o).currentUser.created_at).format("D. MMMM YYYY."),icon:a(ce)},null,8,["label","icon"])]),_:1})])])]),_:1}),e(Ge)]),u("div",Ie,[e(C,{"is-form":"",class:"rounded"},{default:t(()=>[s.account_type!="student"?(c(),f(m,{key:0,label:"Korisni\u010Dko ime"},{default:t(()=>[e(d,{modelValue:s.username,"onUpdate:modelValue":n[0]||(n[0]=l=>s.username=l),icon:a(j),readonly:"",name:"userName",autocomplete:"userName"},null,8,["modelValue","icon"])]),_:1})):J("",!0),e(m,{label:"Ime"},{default:t(()=>[e(d,{modelValue:s.ime,"onUpdate:modelValue":n[1]||(n[1]=l=>s.ime=l),icon:a(j),name:"ime",readonly:"",autocomplete:"ime"},null,8,["modelValue","icon"])]),_:1}),e(m,{label:"Prezime"},{default:t(()=>[e(d,{modelValue:s.prezime,"onUpdate:modelValue":n[2]||(n[2]=l=>s.prezime=l),icon:a(j),name:"prezime",readonly:"",autocomplete:"prezime"},null,8,["modelValue","icon"])]),_:1}),e(m,{label:"E-mail"},{default:t(()=>[e(d,{modelValue:s.email,"onUpdate:modelValue":n[3]||(n[3]=l=>s.email=l),icon:a(pe),type:"email",name:"email",readonly:"",autocomplete:"email"},null,8,["modelValue","icon"])]),_:1}),a(o).userAdmin?J("",!0):(c(),O("div",De,[e(m,{label:"JMBAG"},{default:t(()=>[e(d,{modelValue:s.JMBAG,"onUpdate:modelValue":n[4]||(n[4]=l=>s.JMBAG=l),icon:a(_e),type:"JMBAG",name:"JMBAG",readonly:"",autocomplete:"JMBAG"},null,8,["modelValue","icon"])]),_:1}),e(m,{label:"Godina studija"},{default:t(()=>[e(d,{"model-value":a(ye).getGodinaStudija(s.godina_studija),icon:a(fe),type:"JMBAG",name:"JMBAG",readonly:"",autocomplete:"JMBAG"},null,8,["model-value","icon"])]),_:1})]))]),_:1}),e(C,{"is-form":"",class:"rounded",onSubmit:X(K,["prevent"])},{default:t(()=>[e(m,{label:"Trenutna lozinka",help:"Obavezno. Va\u0161a trenutna lozinka"},{default:t(()=>[e(d,{modelValue:r.password_current,"onUpdate:modelValue":n[5]||(n[5]=l=>r.password_current=l),icon:a(ve),error:a(S)(a(g),"password_current"),name:"password_current",type:"password",required:"",autocomplete:"password_current"},null,8,["modelValue","icon","error"])]),_:1}),e(he),e(m,{label:"Nova lozinka",help:"Obavezno. Va\u0161a nova lozinka"},{default:t(()=>[e(d,{modelValue:r.password,"onUpdate:modelValue":n[6]||(n[6]=l=>r.password=l),icon:a(F),required:"",error:a(S)(a(g),"password"),type:"password",name:"password",autocomplete:"password"},null,8,["modelValue","icon","error"])]),_:1}),e(m,{label:"Potvrdi lozinku",help:"Obavezno. Nova lozinka jo\u0161 jednom"},{default:t(()=>[e(d,{modelValue:r.password_confirmation,"onUpdate:modelValue":n[7]||(n[7]=l=>r.password_confirmation=l),icon:a(F),required:"",error:a(S)(a(g),"password_confirmation"),type:"password",name:"password_confirmation",autocomplete:"password_confirmation"},null,8,["modelValue","icon","error"])]),_:1}),e(I,null,{default:t(()=>[e(M,{disabled:b.value,loading:b.value,type:"submit",color:"fipu_blue",label:"A\u017Euriraj!"},null,8,["disabled","loading"])]),_:1}),e(Z,{ref_key:"notificationBar",ref:p,class:"animate__animated animate__fadeInUp mt-2",outline:U.value},{right:t(()=>[e(M,{icon:h.mdiClose,color:U.value?"success":"white",outline:U.value,"rounded-full":"",small:""},null,8,["icon","color","outline"])]),default:t(()=>[u("b",null,A(a(x)),1),H(" "+A(a(z))+" ",1)]),_:1},8,["outline"])]),_:1},8,["onSubmit"])])]),_:1})]),_:1})}}};export{ia as default};
